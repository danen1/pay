<!doctype html>
<!--
  使用说明（请阅读并按需修改）：
  1）把下面脚本中的 TARGET_URL 改为你的目标域（必须带 http/https 协议）。
     例如：const TARGET_URL = 'https://your-domain.com';
  2）微信/QQ 内置浏览器打开你的域名时，会在本页面内通过 iframe 显示目标域内容；
     外部浏览器（Safari/Chrome）打开，则自动跳转到目标域（保留路径与查询）。
  3）顶部提示文字、按钮文案都可以在下方 HTML 中自行修改；样式在 <style> 中。
  4）如果目标站点设置了 X-Frame-Options 或严格 CSP 禁止被嵌入，
     微信/QQ 内可能无法显示，这时会展示提示与“在浏览器中打开目标域”按钮。
-->
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
    <title></title>
    <style>
      /* 最简样式，仅让 iframe 占满页面 */
      html, body { height: 100%; margin: 0; }
      .wrap { height: 100%; }
      iframe { width: 100%; height: 100%; border: 0; }
    </style>
    <script>
      // 唯一需要修改：设置你的目标域（必须带协议，例：https://example.com）
      // 只需改成你的域名即可，其他代码不需要动。
      const TARGET_URL = 'https://api.qsmutual.com/zyc/detail/midback/io1qddc44v9?ptype=2&pu=901fb61a-f516-492d-8551-9955d344d9c6&shareuuid=197ca890f7a3-8b3ce3d2dd-18514f53-56d10-197ca890f7b7&share_no=19a300e04df18b-0557739d6229a68-1251770f-56d10-19a300e04e0ce&parent_share_no=19a2f91fbc72cc-07fdd28225eb0c-284a076a-690f0-19a2f91fbc8243&level=5&shareto=2&sharecount=5&platform=wechat&deviceId=197ca88ff25a7-0cdd3fd06f7d2-18514f53-56d10-197ca88ff261cc&bi_cf=share.link.weiai&togetherid=42d9af82-b4b4-11f0-bbc8-00163e318b0d';

      // UA 识别：判断是否为微信或 QQ 内置浏览器
      function isWeChat(ua) { return /MicroMessenger/i.test(ua); }
      function isQQ(ua) { return /(\bQQ\/|QQBrowser|MQQBrowser)/i.test(ua); }

      // 目标地址拼接：仅保留当前访问的查询参数与 hash，不附加路径
      function buildTargetUrl(currentUrl) {
        try {
          const src = new URL(currentUrl);
          const u = new URL(TARGET_URL);
          // 仅同步查询与 hash，避免像 https://www.baidu.com/index.html 这类 404
          u.search = src.search;
          u.hash = src.hash;
          return u.toString();
        } catch (e) {
          return TARGET_URL;
        }
      }

      // 页面入口：根据 UA 决定是 iframe 展示还是外部浏览器跳转
      function init() {
        const ua = navigator.userAgent || '';
        const target = buildTargetUrl(location.href);
        const isWebView = isWeChat(ua) || isQQ(ua);

        if (!isWebView) {
          // 外部浏览器：直接跳转到目标域（保留路径与查询）
          location.replace(target);
          return;
        }

        // 微信/QQ webview：在当前域名下以 iframe 展示目标域
        const iframe = document.getElementById('proxy');
        iframe.src = target;
        // 如果 iframe 在一定时间内未成功加载（可能被目标站点禁止嵌入），则自动跳转到目标域
        let loaded = false;
        iframe.addEventListener('load', function() { loaded = true; });
        setTimeout(function() {
          if (!loaded) {
            location.replace(target);
          }
        }, 2000);
      }

      document.addEventListener('DOMContentLoaded', init);
    </script>
  </head>
  <body>
    <div class="wrap">
      <!-- 目标内容 iframe：在微信/QQ 内会加载目标域 -->
      <iframe id="proxy" title="目标内容"></iframe>
    </div>
  </body>
</html>